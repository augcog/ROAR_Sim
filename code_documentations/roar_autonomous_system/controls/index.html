
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="Robot Autonomous Racing DeCal is a course dedicated to teaching students to gain a holistic view and hands-on(virtual) experiences about building a high-performance fully-autonomous 1/10 scale RC car from scratch." name="description"/>
<link href="https://roar-decal.github.io/Carla/code_documentations/roar_autonomous_system/controls/" rel="canonical"/>
<link href="../../../assets/images/favicon.png" rel="shortcut icon"/>
<meta content="mkdocs-1.1.2, mkdocs-material-5.5.3" name="generator"/>
<title>Control - ROAR</title>
<link href="../../../assets/stylesheets/main.947af8d5.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&amp;display=fallback" rel="stylesheet"/>
<style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
</head>
<body dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#ROAR.roar_autonomous_system.control_module.controller.Controller">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header" data-md-component="header">
<nav aria-label="Header" class="md-header-nav md-grid">
<a aria-label="ROAR" class="md-header-nav__button md-logo" href="https://roar-decal.github.io/Carla/" title="ROAR">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"></path></svg>
</a>
<label class="md-header-nav__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"></path></svg>
</label>
<div class="md-header-nav__title" data-md-component="header-title">
<div class="md-header-nav__ellipsis">
<span class="md-header-nav__topic md-ellipsis">
            ROAR
          </span>
<span class="md-header-nav__topic md-ellipsis">
            
              Control
            
          </span>
</div>
</div>
<label class="md-header-nav__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" data-md-state="active" name="query" placeholder="Search" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</label>
<button aria-label="Clear" class="md-search__icon md-icon" data-md-component="search-reset" tabindex="-1" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"></path></svg>
</button>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list"></ol>
</div>
</div>
</div>
</div>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="ROAR" class="md-nav__button md-logo" href="https://roar-decal.github.io/Carla/" title="ROAR">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"></path></svg>
</a>
    ROAR
  </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../.." title="Home">
      Home
    </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" id="nav-2" type="checkbox"/>
<label class="md-nav__link" for="nav-2">
      Project Overview
      <span class="md-nav__icon md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"></path></svg>
</span>
</label>
<nav aria-label="Project Overview" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="nav-2">
<span class="md-nav__icon md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</span>
        Project Overview
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../project_overview/project_module_TADs/" title="Project Module TAD">
      Project Module TAD
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../project_overview/code_layout/" title="Code Layout">
      Code Layout
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" data-md-toggle="nav-3" id="nav-3" type="checkbox"/>
<label class="md-nav__link" for="nav-3">
      Code Documentations
      <span class="md-nav__icon md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"></path></svg>
</span>
</label>
<nav aria-label="Code Documentations" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="nav-3">
<span class="md-nav__icon md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</span>
        Code Documentations
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../bridges/" title="Bridges">
      Bridges
    </a>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" data-md-toggle="nav-3-2" id="nav-3-2" type="checkbox"/>
<label class="md-nav__link" for="nav-3-2">
      ROAR Autonomous System
      <span class="md-nav__icon md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"></path></svg>
</span>
</label>
<nav aria-label="ROAR Autonomous System" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="nav-3-2">
<span class="md-nav__icon md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</span>
        ROAR Autonomous System
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../agents/" title="Agents">
      Agents
    </a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" data-md-toggle="toc" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
        Control
        <span class="md-nav__icon md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 9h14V7H3v2m0 4h14v-2H3v2m0 4h14v-2H3v2m16 0h2v-2h-2v2m0-10v2h2V7h-2m0 6h2v-2h-2v2z"></path></svg>
</span>
</label>
<a class="md-nav__link md-nav__link--active" href="./" title="Control">
      Control
    </a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.controller.Controller">
    Controller
  </a>
<nav aria-label="Controller" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.controller.Controller.__init__">
    __init__()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.controller.Controller.run_step">
    run_step()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.controller.Controller.sync_data">
    sync_data()
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.mpc_controller.VehicleMPCController">
    VehicleMPCController
  </a>
<nav aria-label="VehicleMPCController" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.mpc_controller.VehicleMPCController.__init__">
    __init__()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.mpc_controller.VehicleMPCController.clip_throttle">
    clip_throttle()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.mpc_controller.VehicleMPCController.create_array_of_symbols">
    create_array_of_symbols()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.mpc_controller.VehicleMPCController.generate_fun">
    generate_fun()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.mpc_controller.VehicleMPCController.generate_grad">
    generate_grad()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.mpc_controller.VehicleMPCController.get_closest_waypoint_index_2D">
    get_closest_waypoint_index_2D()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.mpc_controller.VehicleMPCController.get_closest_waypoint_index_3D">
    get_closest_waypoint_index_3D()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.mpc_controller.VehicleMPCController.get_func_constraints_and_bounds">
    get_func_constraints_and_bounds()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.mpc_controller.VehicleMPCController.get_state0">
    get_state0()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.mpc_controller.VehicleMPCController.minimize_cost">
    minimize_cost()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.mpc_controller.VehicleMPCController.run_step">
    run_step()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.mpc_controller.VehicleMPCController.sync_data">
    sync_data()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.mpc_controller.VehicleMPCController.transform_into_cars_coordinate_system">
    transform_into_cars_coordinate_system()
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.pid_controller.OPTIMIZED_LATERAL_PID_VALUES">
    OPTIMIZED_LATERAL_PID_VALUES
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.pid_controller.PIDLateralController">
    PIDLateralController
  </a>
<nav aria-label="PIDLateralController" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.pid_controller.PIDLateralController.__init__">
    __init__()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.pid_controller.PIDLateralController.run_step">
    run_step()
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.pid_controller.PIDLongitudinalController">
    PIDLongitudinalController
  </a>
<nav aria-label="PIDLongitudinalController" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.pid_controller.PIDLongitudinalController.__init__">
    __init__()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.pid_controller.PIDLongitudinalController.run_step">
    run_step()
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.pid_controller.PIDParam">
    PIDParam
  </a>
<nav aria-label="PIDParam" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.pid_controller.PIDParam.dt">
    dt
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.pid_controller.PIDParam.K_D">
    K_D
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.pid_controller.PIDParam.K_I">
    K_I
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.pid_controller.PIDParam.K_P">
    K_P
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.pid_controller.PIDParam.__config__">
    __config__
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.pid_controller.PIDParam.__json_encoder__">
    __json_encoder__()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.pid_controller.PIDParam.default_lateral_param">
    default_lateral_param()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.pid_controller.PIDParam.default_longitudinal_param">
    default_longitudinal_param()
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.pid_controller.VehiclePIDController">
    VehiclePIDController
  </a>
<nav aria-label="VehiclePIDController" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.pid_controller.VehiclePIDController.__init__">
    __init__()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.pid_controller.VehiclePIDController.run_step">
    run_step()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.pid_controller.VehiclePIDController.sync_data">
    sync_data()
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.pure_pursuit_control.LatitunalPurePursuitController">
    LatitunalPurePursuitController
  </a>
<nav aria-label="LatitunalPurePursuitController" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.pure_pursuit_control.LatitunalPurePursuitController.__init__">
    __init__()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.pure_pursuit_control.LatitunalPurePursuitController.run_step">
    run_step()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.pure_pursuit_control.LatitunalPurePursuitController.sync">
    sync()
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.pure_pursuit_control.LongitunalPurePursuitController">
    LongitunalPurePursuitController
  </a>
<nav aria-label="LongitunalPurePursuitController" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.pure_pursuit_control.LongitunalPurePursuitController.__init__">
    __init__()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.pure_pursuit_control.LongitunalPurePursuitController.run_step">
    run_step()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.pure_pursuit_control.LongitunalPurePursuitController.sync">
    sync()
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.pure_pursuit_control.PurePursuitController">
    PurePursuitController
  </a>
<nav aria-label="PurePursuitController" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.pure_pursuit_control.PurePursuitController.__init__">
    __init__()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.pure_pursuit_control.PurePursuitController.run_step">
    run_step()
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../perceptions/" title="Perception">
      Perception
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../visualizations/" title="Visualization">
      Visualization
    </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-2-5" id="nav-3-2-5" type="checkbox"/>
<label class="md-nav__link" for="nav-3-2-5">
      Planning
      <span class="md-nav__icon md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"></path></svg>
</span>
</label>
<nav aria-label="Planning" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="nav-3-2-5">
<span class="md-nav__icon md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</span>
        Planning
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../planning/mission_planners/" title="Mission Planner">
      Mission Planner
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../planning/behavior_planners/" title="Behavior Planner">
      Behavior Planner
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../planning/local_planners/" title="Local Planner">
      Local Planner
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-2-6" id="nav-3-2-6" type="checkbox"/>
<label class="md-nav__link" for="nav-3-2-6">
      Utilities
      <span class="md-nav__icon md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"></path></svg>
</span>
</label>
<nav aria-label="Utilities" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="nav-3-2-6">
<span class="md-nav__icon md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</span>
        Utilities
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../utilities/cameras/" title="Camera">
      Camera
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../utilities/data_structures/" title="Data Structures">
      Data Structures
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../utilities/vehicles/" title="Vehicle">
      Vehicle
    </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.controller.Controller">
    Controller
  </a>
<nav aria-label="Controller" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.controller.Controller.__init__">
    __init__()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.controller.Controller.run_step">
    run_step()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.controller.Controller.sync_data">
    sync_data()
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.mpc_controller.VehicleMPCController">
    VehicleMPCController
  </a>
<nav aria-label="VehicleMPCController" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.mpc_controller.VehicleMPCController.__init__">
    __init__()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.mpc_controller.VehicleMPCController.clip_throttle">
    clip_throttle()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.mpc_controller.VehicleMPCController.create_array_of_symbols">
    create_array_of_symbols()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.mpc_controller.VehicleMPCController.generate_fun">
    generate_fun()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.mpc_controller.VehicleMPCController.generate_grad">
    generate_grad()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.mpc_controller.VehicleMPCController.get_closest_waypoint_index_2D">
    get_closest_waypoint_index_2D()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.mpc_controller.VehicleMPCController.get_closest_waypoint_index_3D">
    get_closest_waypoint_index_3D()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.mpc_controller.VehicleMPCController.get_func_constraints_and_bounds">
    get_func_constraints_and_bounds()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.mpc_controller.VehicleMPCController.get_state0">
    get_state0()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.mpc_controller.VehicleMPCController.minimize_cost">
    minimize_cost()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.mpc_controller.VehicleMPCController.run_step">
    run_step()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.mpc_controller.VehicleMPCController.sync_data">
    sync_data()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.mpc_controller.VehicleMPCController.transform_into_cars_coordinate_system">
    transform_into_cars_coordinate_system()
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.pid_controller.OPTIMIZED_LATERAL_PID_VALUES">
    OPTIMIZED_LATERAL_PID_VALUES
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.pid_controller.PIDLateralController">
    PIDLateralController
  </a>
<nav aria-label="PIDLateralController" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.pid_controller.PIDLateralController.__init__">
    __init__()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.pid_controller.PIDLateralController.run_step">
    run_step()
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.pid_controller.PIDLongitudinalController">
    PIDLongitudinalController
  </a>
<nav aria-label="PIDLongitudinalController" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.pid_controller.PIDLongitudinalController.__init__">
    __init__()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.pid_controller.PIDLongitudinalController.run_step">
    run_step()
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.pid_controller.PIDParam">
    PIDParam
  </a>
<nav aria-label="PIDParam" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.pid_controller.PIDParam.dt">
    dt
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.pid_controller.PIDParam.K_D">
    K_D
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.pid_controller.PIDParam.K_I">
    K_I
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.pid_controller.PIDParam.K_P">
    K_P
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.pid_controller.PIDParam.__config__">
    __config__
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.pid_controller.PIDParam.__json_encoder__">
    __json_encoder__()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.pid_controller.PIDParam.default_lateral_param">
    default_lateral_param()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.pid_controller.PIDParam.default_longitudinal_param">
    default_longitudinal_param()
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.pid_controller.VehiclePIDController">
    VehiclePIDController
  </a>
<nav aria-label="VehiclePIDController" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.pid_controller.VehiclePIDController.__init__">
    __init__()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.pid_controller.VehiclePIDController.run_step">
    run_step()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.pid_controller.VehiclePIDController.sync_data">
    sync_data()
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.pure_pursuit_control.LatitunalPurePursuitController">
    LatitunalPurePursuitController
  </a>
<nav aria-label="LatitunalPurePursuitController" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.pure_pursuit_control.LatitunalPurePursuitController.__init__">
    __init__()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.pure_pursuit_control.LatitunalPurePursuitController.run_step">
    run_step()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.pure_pursuit_control.LatitunalPurePursuitController.sync">
    sync()
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.pure_pursuit_control.LongitunalPurePursuitController">
    LongitunalPurePursuitController
  </a>
<nav aria-label="LongitunalPurePursuitController" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.pure_pursuit_control.LongitunalPurePursuitController.__init__">
    __init__()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.pure_pursuit_control.LongitunalPurePursuitController.run_step">
    run_step()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.pure_pursuit_control.LongitunalPurePursuitController.sync">
    sync()
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.pure_pursuit_control.PurePursuitController">
    PurePursuitController
  </a>
<nav aria-label="PurePursuitController" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.pure_pursuit_control.PurePursuitController.__init__">
    __init__()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ROAR.roar_autonomous_system.control_module.pure_pursuit_control.PurePursuitController.run_step">
    run_step()
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content">
<article class="md-content__inner md-typeset">
<h1>Control</h1>
<div class="doc doc-object doc-module">
<div class="doc doc-contents first">
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h2 class="doc doc-heading" id="ROAR.roar_autonomous_system.control_module.controller.Controller">
<code>Controller</code>
<a class="headerlink" href="#ROAR.roar_autonomous_system.control_module.controller.Controller" title="Permanent link">¤</a></h2>
<div class="doc doc-contents">
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="ROAR.roar_autonomous_system.control_module.controller.Controller.__init__">
<code class="highlight language-python">
__init__<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vehicle</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#ROAR.roar_autonomous_system.control_module.controller.Controller.__init__" title="Permanent link">¤</a></h3>
<div class="doc doc-contents">
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>vehicle</code></td>
<td><code>Vehicle</code></td>
<td>
<p>Vehicle instance</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>ROAR/roar_autonomous_system/control_module/controller.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>12
13
14
15
16
17
18
19
20</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vehicle</span><span class="p">:</span> <span class="n">Vehicle</span><span class="p">):</span>
    <span class="sd">"""</span>

<span class="sd">    Args:</span>
<span class="sd">        vehicle: Vehicle instance</span>

<span class="sd">    """</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">vehicle</span> <span class="o">=</span> <span class="n">vehicle</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="ROAR.roar_autonomous_system.control_module.controller.Controller.run_step">
<code class="highlight language-python">
run_step<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vehicle</span><span class="p">,</span> <span class="n">next_waypoint</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> </code>
<a class="headerlink" href="#ROAR.roar_autonomous_system.control_module.controller.Controller.run_step" title="Permanent link">¤</a></h3>
<div class="doc doc-contents">
<p>Abstract function for run step</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>vehicle</code></td>
<td><code>Vehicle</code></td>
<td>
<p>new vehicle state</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>next_waypoint</code></td>
<td><code>Transform</code></td>
<td>
<p>next waypoint</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>**kwargs</code></td>
<td><code></code></td>
<td></td>
<td><code>{}</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>VehicleControl</code></td>
<td>
<p>VehicleControl</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>ROAR/roar_autonomous_system/control_module/controller.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">def</span> <span class="nf">run_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vehicle</span><span class="p">:</span> <span class="n">Vehicle</span><span class="p">,</span> <span class="n">next_waypoint</span><span class="p">:</span> <span class="n">Transform</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> \
        <span class="o">-&gt;</span> <span class="n">VehicleControl</span><span class="p">:</span>
    <span class="sd">"""</span>
<span class="sd">    Abstract function for run step</span>

<span class="sd">    Args:</span>
<span class="sd">        vehicle: new vehicle state</span>
<span class="sd">        next_waypoint: next waypoint</span>
<span class="sd">        **kwargs:</span>

<span class="sd">    Returns:</span>
<span class="sd">        VehicleControl</span>
<span class="sd">    """</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">sync_data</span><span class="p">(</span><span class="n">vehicle</span><span class="o">=</span><span class="n">vehicle</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">VehicleControl</span><span class="p">()</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="ROAR.roar_autonomous_system.control_module.controller.Controller.sync_data">
<code class="highlight language-python">
sync_data<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vehicle</span><span class="p">)</span> </code>
<a class="headerlink" href="#ROAR.roar_autonomous_system.control_module.controller.Controller.sync_data" title="Permanent link">¤</a></h3>
<div class="doc doc-contents">
<p>default sync data function</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>vehicle</code></td>
<td><code>Vehicle</code></td>
<td>
<p>new vehicle state</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>None</code></td>
<td>
<p>None</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>ROAR/roar_autonomous_system/control_module/controller.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>39
40
41
42
43
44
45
46
47
48
49</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">sync_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vehicle</span><span class="p">:</span> <span class="n">Vehicle</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">"""</span>
<span class="sd">    default sync data function</span>
<span class="sd">    Args:</span>
<span class="sd">        vehicle: new vehicle state</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>

<span class="sd">    """</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">vehicle</span> <span class="o">=</span> <span class="n">vehicle</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<div class="doc doc-contents first">
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h2 class="doc doc-heading" id="ROAR.roar_autonomous_system.control_module.mpc_controller.VehicleMPCController">
<code>VehicleMPCController</code>
<a class="headerlink" href="#ROAR.roar_autonomous_system.control_module.mpc_controller.VehicleMPCController" title="Permanent link">¤</a></h2>
<div class="doc doc-contents">
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="ROAR.roar_autonomous_system.control_module.mpc_controller.VehicleMPCController.__init__">
<code class="highlight language-python">
__init__<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vehicle</span><span class="p">,</span> <span class="n">route_file_path</span><span class="p">,</span> <span class="n">target_speed</span><span class="o">=</span><span class="n">inf</span><span class="p">,</span> <span class="n">steps_ahead</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">max_throttle</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_steering</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#ROAR.roar_autonomous_system.control_module.mpc_controller.VehicleMPCController.__init__" title="Permanent link">¤</a></h3>
<div class="doc doc-contents">
<details class="quote">
<summary>Source code in <code>ROAR/roar_autonomous_system/control_module/mpc_controller.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span> 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
             <span class="n">vehicle</span><span class="p">:</span> <span class="n">Vehicle</span><span class="p">,</span>
             <span class="n">route_file_path</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>  <span class="c1"># read in route</span>
             <span class="n">target_speed</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="s2">"inf"</span><span class="p">),</span>
             <span class="n">steps_ahead</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
             <span class="n">max_throttle</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
             <span class="n">max_steering</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
             <span class="n">dt</span><span class="o">=</span><span class="mf">0.1</span><span class="p">):</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">vehicle</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
    <span class="c1"># Read in route file</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">track_DF</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">route_file_path</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="c1"># Fit the route to a curve</span>
    <span class="n">spline_points</span> <span class="o">=</span> <span class="mi">10000</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pts_2D</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">track_DF</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>
    <span class="n">tck</span><span class="p">,</span> <span class="n">u</span> <span class="o">=</span> <span class="n">splprep</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pts_2D</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">u</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">per</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">u_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">u</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">spline_points</span><span class="p">)</span>
    <span class="n">x_new</span><span class="p">,</span> <span class="n">y_new</span> <span class="o">=</span> <span class="n">splev</span><span class="p">(</span><span class="n">u_new</span><span class="p">,</span> <span class="n">tck</span><span class="p">,</span> <span class="n">der</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pts_2D</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">x_new</span><span class="p">,</span> <span class="n">y_new</span><span class="p">]</span>

    <span class="c1"># Modified parm</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">prev_cte</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">target_speed</span> <span class="o">=</span> <span class="n">target_speed</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">state_vars</span> <span class="o">=</span> <span class="p">(</span><span class="s1">'x'</span><span class="p">,</span> <span class="s1">'y'</span><span class="p">,</span> <span class="s1">'v'</span><span class="p">,</span> <span class="s1">'ψ'</span><span class="p">,</span> <span class="s1">'cte'</span><span class="p">,</span> <span class="s1">'eψ'</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">steps_ahead</span> <span class="o">=</span> <span class="n">steps_ahead</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dt</span> <span class="o">=</span> <span class="n">dt</span>

    <span class="c1"># Cost function coefficients</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">cte_coeff</span> <span class="o">=</span> <span class="mi">100</span>  <span class="c1"># 100</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">epsi_coeff</span> <span class="o">=</span> <span class="mi">100</span>  <span class="c1"># 100</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">speed_coeff</span> <span class="o">=</span> <span class="mf">0.4</span>  <span class="c1"># 0.2</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">acc_coeff</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># 1</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">steer_coeff</span> <span class="o">=</span> <span class="mf">0.1</span>  <span class="c1"># 0.1</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">consec_acc_coeff</span> <span class="o">=</span> <span class="mi">50</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">consec_steer_coeff</span> <span class="o">=</span> <span class="mi">50</span>

    <span class="c1"># Front wheel L</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">Lf</span> <span class="o">=</span> <span class="mf">2.5</span>

    <span class="c1"># How the polynomial fitting the desired curve is fitted</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">steps_poly</span> <span class="o">=</span> <span class="mi">30</span>  <span class="c1"># modify to 3 when using 3D data</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">poly_degree</span> <span class="o">=</span> <span class="mi">3</span>

    <span class="c1"># Bounds for the optimizer</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">bounds</span> <span class="o">=</span> <span class="p">(</span>
            <span class="mi">6</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">steps_ahead</span> <span class="o">*</span> <span class="p">[(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)]</span>
            <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">steps_ahead</span> <span class="o">*</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_throttle</span><span class="p">)]</span>  <span class="c1"># throttle bounds</span>
            <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">steps_ahead</span> <span class="o">*</span> <span class="p">[(</span><span class="o">-</span><span class="n">max_steering</span><span class="p">,</span> <span class="n">max_steering</span><span class="p">)]</span>
    <span class="c1"># steer bounds</span>
    <span class="p">)</span>

    <span class="c1"># State 0 placeholder</span>
    <span class="n">num_vars</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">state_vars</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># State variables and two actuators</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">state0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">steps_ahead</span> <span class="o">*</span> <span class="n">num_vars</span><span class="p">)</span>

    <span class="c1"># Lambdify and minimize stuff</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">evaluator</span> <span class="o">=</span> <span class="s1">'numpy'</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">tolerance</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">cost_func</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cost_grad_func</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">constr_funcs</span> <span class="o">=</span> \
        <span class="bp">self</span><span class="o">.</span><span class="n">get_func_constraints_and_bounds</span><span class="p">()</span>

    <span class="c1"># To keep the previous state</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">steer</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">throttle</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">"MPC Controller initiated"</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="ROAR.roar_autonomous_system.control_module.mpc_controller.VehicleMPCController.clip_throttle">
<code class="highlight language-python">
clip_throttle<span class="p">(</span><span class="n">throttle</span><span class="p">,</span> <span class="n">curr_speed</span><span class="p">,</span> <span class="n">target_speed</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
</span>
<a class="headerlink" href="#ROAR.roar_autonomous_system.control_module.mpc_controller.VehicleMPCController.clip_throttle" title="Permanent link">¤</a></h3>
<div class="doc doc-contents">
<details class="quote">
<summary>Source code in <code>ROAR/roar_autonomous_system/control_module/mpc_controller.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>410
411
412
413
414
415
416</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">clip_throttle</span><span class="p">(</span><span class="n">throttle</span><span class="p">,</span> <span class="n">curr_speed</span><span class="p">,</span> <span class="n">target_speed</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span>
        <span class="n">throttle</span> <span class="o">-</span> <span class="mf">0.01</span> <span class="o">*</span> <span class="p">(</span><span class="n">curr_speed</span> <span class="o">-</span> <span class="n">target_speed</span><span class="p">),</span>
        <span class="mf">0.4</span><span class="p">,</span>
        <span class="mf">0.9</span>
    <span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="ROAR.roar_autonomous_system.control_module.mpc_controller.VehicleMPCController.create_array_of_symbols">
<code class="highlight language-python">
create_array_of_symbols<span class="p">(</span><span class="n">str_symbol</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
</span>
<a class="headerlink" href="#ROAR.roar_autonomous_system.control_module.mpc_controller.VehicleMPCController.create_array_of_symbols" title="Permanent link">¤</a></h3>
<div class="doc doc-contents">
<details class="quote">
<summary>Source code in <code>ROAR/roar_autonomous_system/control_module/mpc_controller.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>398
399
400</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">create_array_of_symbols</span><span class="p">(</span><span class="n">str_symbol</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">'</span><span class="si">{symbol}</span><span class="s1">0:</span><span class="si">{N}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">symbol</span><span class="o">=</span><span class="n">str_symbol</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="n">N</span><span class="p">))</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="ROAR.roar_autonomous_system.control_module.mpc_controller.VehicleMPCController.generate_fun">
<code class="highlight language-python">
generate_fun<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">symb_fun</span><span class="p">,</span> <span class="n">vars_</span><span class="p">,</span> <span class="n">init</span><span class="p">,</span> <span class="n">poly</span><span class="p">)</span> </code>
<a class="headerlink" href="#ROAR.roar_autonomous_system.control_module.mpc_controller.VehicleMPCController.generate_fun" title="Permanent link">¤</a></h3>
<div class="doc doc-contents">
<p>Generates a function of the form <code>fun(x, *args)</code></p>
<details class="quote">
<summary>Source code in <code>ROAR/roar_autonomous_system/control_module/mpc_controller.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>317
318
319
320
321
322</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">generate_fun</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">symb_fun</span><span class="p">,</span> <span class="n">vars_</span><span class="p">,</span> <span class="n">init</span><span class="p">,</span> <span class="n">poly</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Generates a function of the form `fun(x, *args)`</span>
<span class="sd">    """</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">init</span> <span class="o">+</span> <span class="n">poly</span>
    <span class="k">return</span> <span class="n">sym</span><span class="o">.</span><span class="n">lambdify</span><span class="p">((</span><span class="n">vars_</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">),</span> <span class="n">symb_fun</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluator</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="ROAR.roar_autonomous_system.control_module.mpc_controller.VehicleMPCController.generate_grad">
<code class="highlight language-python">
generate_grad<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">symb_fun</span><span class="p">,</span> <span class="n">vars_</span><span class="p">,</span> <span class="n">init</span><span class="p">,</span> <span class="n">poly</span><span class="p">)</span> </code>
<a class="headerlink" href="#ROAR.roar_autonomous_system.control_module.mpc_controller.VehicleMPCController.generate_grad" title="Permanent link">¤</a></h3>
<div class="doc doc-contents">
<p>TODO: add comments</p>
<details class="quote">
<summary>Source code in <code>ROAR/roar_autonomous_system/control_module/mpc_controller.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>324
325
326
327
328
329
330
331
332
333</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">generate_grad</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">symb_fun</span><span class="p">,</span> <span class="n">vars_</span><span class="p">,</span> <span class="n">init</span><span class="p">,</span> <span class="n">poly</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    TODO: add comments</span>
<span class="sd">    """</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">init</span> <span class="o">+</span> <span class="n">poly</span>
    <span class="k">return</span> <span class="n">sym</span><span class="o">.</span><span class="n">lambdify</span><span class="p">(</span>
        <span class="p">(</span><span class="n">vars_</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">),</span>
        <span class="n">derive_by_array</span><span class="p">(</span><span class="n">symb_fun</span><span class="p">,</span> <span class="n">vars_</span> <span class="o">+</span> <span class="n">args</span><span class="p">)[:</span><span class="nb">len</span><span class="p">(</span><span class="n">vars_</span><span class="p">)],</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">evaluator</span>
    <span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="ROAR.roar_autonomous_system.control_module.mpc_controller.VehicleMPCController.get_closest_waypoint_index_2D">
<code class="highlight language-python">
get_closest_waypoint_index_2D<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">car_location</span><span class="p">,</span> <span class="n">waypoint_location</span><span class="p">)</span> </code>
<a class="headerlink" href="#ROAR.roar_autonomous_system.control_module.mpc_controller.VehicleMPCController.get_closest_waypoint_index_2D" title="Permanent link">¤</a></h3>
<div class="doc doc-contents">
<p>Get the index of the closest waypoint in self.pts_2D
Note: it may give wrong index when the route is overlapped</p>
<details class="quote">
<summary>Source code in <code>ROAR/roar_autonomous_system/control_module/mpc_controller.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>387
388
389
390
391
392
393
394
395
396</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">get_closest_waypoint_index_2D</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">car_location</span><span class="p">,</span> <span class="n">waypoint_location</span><span class="p">):</span>
    <span class="sd">"""Get the index of the closest waypoint in self.pts_2D</span>
<span class="sd">        Note: it may give wrong index when the route is overlapped</span>
<span class="sd">    """</span>
    <span class="n">location_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
        <span class="n">car_location</span><span class="o">.</span><span class="n">x</span><span class="p">,</span>
        <span class="n">car_location</span><span class="o">.</span><span class="n">y</span>
    <span class="p">])</span>
    <span class="n">dists</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pts_2D</span> <span class="o">-</span> <span class="n">location_arr</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">dists</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="ROAR.roar_autonomous_system.control_module.mpc_controller.VehicleMPCController.get_closest_waypoint_index_3D">
<code class="highlight language-python">
get_closest_waypoint_index_3D<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">car_location</span><span class="p">,</span> <span class="n">waypoint_location</span><span class="p">)</span> </code>
<a class="headerlink" href="#ROAR.roar_autonomous_system.control_module.mpc_controller.VehicleMPCController.get_closest_waypoint_index_3D" title="Permanent link">¤</a></h3>
<div class="doc doc-contents">
<p>Get the index of the closest waypoint in self.track_DF
car_location: current car location
waypoint_location: next_waypoint</p>
<details class="quote">
<summary>Source code in <code>ROAR/roar_autonomous_system/control_module/mpc_controller.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">get_closest_waypoint_index_3D</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">car_location</span><span class="p">,</span> <span class="n">waypoint_location</span><span class="p">):</span>
    <span class="sd">"""Get the index of the closest waypoint in self.track_DF</span>
<span class="sd">        car_location: current car location</span>
<span class="sd">        waypoint_location: next_waypoint</span>
<span class="sd">    """</span>
    <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">track_DF</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">track_DF</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">waypoint_location</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
                              <span class="o">&amp;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">track_DF</span><span class="p">[</span>
                                     <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">waypoint_location</span><span class="o">.</span><span class="n">y</span><span class="p">)]</span><span class="o">.</span><span class="n">index</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">index</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">location_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
            <span class="n">car_location</span><span class="o">.</span><span class="n">x</span><span class="p">,</span>
            <span class="n">car_location</span><span class="o">.</span><span class="n">y</span><span class="p">,</span>
            <span class="n">car_location</span><span class="o">.</span><span class="n">z</span><span class="p">,</span>
        <span class="p">])</span>
        <span class="n">dists</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">track_DF</span> <span class="o">-</span> <span class="n">location_arr</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">dists</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="ROAR.roar_autonomous_system.control_module.mpc_controller.VehicleMPCController.get_func_constraints_and_bounds">
<code class="highlight language-python">
get_func_constraints_and_bounds<span class="p">(</span><span class="bp">self</span><span class="p">)</span> </code>
<a class="headerlink" href="#ROAR.roar_autonomous_system.control_module.mpc_controller.VehicleMPCController.get_func_constraints_and_bounds" title="Permanent link">¤</a></h3>
<div class="doc doc-contents">
<p>Defines MPC's cost function and constraints.</p>
<details class="quote">
<summary>Source code in <code>ROAR/roar_autonomous_system/control_module/mpc_controller.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">get_func_constraints_and_bounds</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Defines MPC's cost function and constraints.</span>
<span class="sd">    """</span>
    <span class="c1"># Polynomial coefficients will also be symbolic variables</span>
    <span class="n">poly</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_array_of_symbols</span><span class="p">(</span><span class="s1">'poly'</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">poly_degree</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Initialize the initial state</span>
    <span class="n">x_init</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">'x_init'</span><span class="p">)</span>
    <span class="n">y_init</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">'y_init'</span><span class="p">)</span>
    <span class="n">ψ_init</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">'ψ_init'</span><span class="p">)</span>
    <span class="n">v_init</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">'v_init'</span><span class="p">)</span>
    <span class="n">cte_init</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">'cte_init'</span><span class="p">)</span>
    <span class="n">eψ_init</span> <span class="o">=</span> <span class="n">sym</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">'eψ_init'</span><span class="p">)</span>

    <span class="n">init</span> <span class="o">=</span> <span class="p">(</span><span class="n">x_init</span><span class="p">,</span> <span class="n">y_init</span><span class="p">,</span> <span class="n">ψ_init</span><span class="p">,</span> <span class="n">v_init</span><span class="p">,</span> <span class="n">cte_init</span><span class="p">,</span> <span class="n">eψ_init</span><span class="p">)</span>

    <span class="c1"># State variables</span>
    <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_array_of_symbols</span><span class="p">(</span><span class="s1">'x'</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">steps_ahead</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_array_of_symbols</span><span class="p">(</span><span class="s1">'y'</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">steps_ahead</span><span class="p">)</span>
    <span class="n">ψ</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_array_of_symbols</span><span class="p">(</span><span class="s1">'ψ'</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">steps_ahead</span><span class="p">)</span>
    <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_array_of_symbols</span><span class="p">(</span><span class="s1">'v'</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">steps_ahead</span><span class="p">)</span>
    <span class="n">cte</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_array_of_symbols</span><span class="p">(</span><span class="s1">'cte'</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">steps_ahead</span><span class="p">)</span>
    <span class="n">eψ</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_array_of_symbols</span><span class="p">(</span><span class="s1">'eψ'</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">steps_ahead</span><span class="p">)</span>

    <span class="c1"># Actuators</span>
    <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_array_of_symbols</span><span class="p">(</span><span class="s1">'a'</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">steps_ahead</span><span class="p">)</span>
    <span class="n">δ</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_array_of_symbols</span><span class="p">(</span><span class="s1">'δ'</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">steps_ahead</span><span class="p">)</span>

    <span class="n">vars_</span> <span class="o">=</span> <span class="p">(</span>
        <span class="c1"># Symbolic arrays (but NOT actuators)</span>
        <span class="o">*</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">y</span><span class="p">,</span> <span class="o">*</span><span class="n">ψ</span><span class="p">,</span> <span class="o">*</span><span class="n">v</span><span class="p">,</span> <span class="o">*</span><span class="n">cte</span><span class="p">,</span> <span class="o">*</span><span class="n">eψ</span><span class="p">,</span>

        <span class="c1"># Symbolic arrays (actuators)</span>
        <span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">*</span><span class="n">δ</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">cost</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">steps_ahead</span><span class="p">):</span>
        <span class="n">cost</span> <span class="o">+=</span> <span class="p">(</span>
            <span class="c1"># Reference state penalties</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cte_coeff</span> <span class="o">*</span> <span class="n">cte</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span>
                <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">epsi_coeff</span> <span class="o">*</span> <span class="n">eψ</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span>
                <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">speed_coeff</span> <span class="o">*</span> <span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_speed</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>

                <span class="c1"># Actuator penalties</span>
                <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">acc_coeff</span> <span class="o">*</span> <span class="n">a</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span>
                <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">steer_coeff</span> <span class="o">*</span> <span class="n">δ</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span>
        <span class="p">)</span>

    <span class="c1"># Penalty for differences in consecutive actuators</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">steps_ahead</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">cost</span> <span class="o">+=</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">consec_acc_coeff</span> <span class="o">*</span> <span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">t</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">a</span><span class="p">[</span><span class="n">t</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span>
                <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">consec_steer_coeff</span> <span class="o">*</span> <span class="p">(</span><span class="n">δ</span><span class="p">[</span><span class="n">t</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">δ</span><span class="p">[</span><span class="n">t</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span>
        <span class="p">)</span>

    <span class="c1"># Initialize constraints</span>
    <span class="n">eq_constr</span> <span class="o">=</span> <span class="n">_EqualityConstraints</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">steps_ahead</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">state_vars</span><span class="p">)</span>
    <span class="n">eq_constr</span><span class="p">[</span><span class="s1">'x'</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">x_init</span>
    <span class="n">eq_constr</span><span class="p">[</span><span class="s1">'y'</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">y_init</span>
    <span class="n">eq_constr</span><span class="p">[</span><span class="s1">'ψ'</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">ψ</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">ψ_init</span>
    <span class="n">eq_constr</span><span class="p">[</span><span class="s1">'v'</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">v_init</span>
    <span class="n">eq_constr</span><span class="p">[</span><span class="s1">'cte'</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">cte</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">cte_init</span>
    <span class="n">eq_constr</span><span class="p">[</span><span class="s1">'eψ'</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">eψ</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">eψ_init</span>

    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">steps_ahead</span><span class="p">):</span>
        <span class="n">curve</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span>
            <span class="n">poly</span><span class="p">[</span><span class="o">-</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="n">t</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">**</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">poly</span><span class="p">)))</span>
        <span class="c1"># The desired ψ is equal to the derivative of the polynomial</span>
        <span class="c1"># curve at</span>
        <span class="c1">#  point x[t-1]</span>
        <span class="n">ψdes</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">poly</span><span class="p">[</span><span class="o">-</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span> <span class="o">*</span> <span class="n">i</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="n">t</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">**</span> <span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span>
                   <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">poly</span><span class="p">)))</span>

        <span class="n">eq_constr</span><span class="p">[</span><span class="s1">'x'</span><span class="p">][</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span>
                    <span class="n">x</span><span class="p">[</span><span class="n">t</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">v</span><span class="p">[</span><span class="n">t</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">sym</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">ψ</span><span class="p">[</span><span class="n">t</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">dt</span><span class="p">)</span>
        <span class="n">eq_constr</span><span class="p">[</span><span class="s1">'y'</span><span class="p">][</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span>
                    <span class="n">y</span><span class="p">[</span><span class="n">t</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">v</span><span class="p">[</span><span class="n">t</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">sym</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">ψ</span><span class="p">[</span><span class="n">t</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">dt</span><span class="p">)</span>
        <span class="n">eq_constr</span><span class="p">[</span><span class="s1">'ψ'</span><span class="p">][</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="n">ψ</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span>
                    <span class="n">ψ</span><span class="p">[</span><span class="n">t</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">v</span><span class="p">[</span><span class="n">t</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">δ</span><span class="p">[</span><span class="n">t</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">Lf</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">dt</span><span class="p">)</span>
        <span class="n">eq_constr</span><span class="p">[</span><span class="s1">'v'</span><span class="p">][</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">t</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">a</span><span class="p">[</span><span class="n">t</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">dt</span><span class="p">)</span>
        <span class="n">eq_constr</span><span class="p">[</span><span class="s1">'cte'</span><span class="p">][</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="n">cte</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span>
                    <span class="n">curve</span> <span class="o">-</span> <span class="n">y</span><span class="p">[</span><span class="n">t</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">v</span><span class="p">[</span><span class="n">t</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">sym</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span>
                <span class="n">eψ</span><span class="p">[</span><span class="n">t</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">dt</span><span class="p">)</span>
        <span class="n">eq_constr</span><span class="p">[</span><span class="s1">'eψ'</span><span class="p">][</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="n">eψ</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="n">ψ</span><span class="p">[</span><span class="n">t</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">ψdes</span> <span class="o">-</span> <span class="n">v</span><span class="p">[</span><span class="n">t</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">δ</span><span class="p">[</span>
            <span class="n">t</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">Lf</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">dt</span><span class="p">)</span>

    <span class="c1"># Generate actual functions from</span>
    <span class="n">cost_func</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_fun</span><span class="p">(</span><span class="n">cost</span><span class="p">,</span> <span class="n">vars_</span><span class="p">,</span> <span class="n">init</span><span class="p">,</span> <span class="n">poly</span><span class="p">)</span>
    <span class="n">cost_grad_func</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_grad</span><span class="p">(</span><span class="n">cost</span><span class="p">,</span> <span class="n">vars_</span><span class="p">,</span> <span class="n">init</span><span class="p">,</span> <span class="n">poly</span><span class="p">)</span>

    <span class="n">constr_funcs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">symbol</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">state_vars</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">steps_ahead</span><span class="p">):</span>
            <span class="n">func</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_fun</span><span class="p">(</span><span class="n">eq_constr</span><span class="p">[</span><span class="n">symbol</span><span class="p">][</span><span class="n">t</span><span class="p">],</span> <span class="n">vars_</span><span class="p">,</span> <span class="n">init</span><span class="p">,</span>
                                     <span class="n">poly</span><span class="p">)</span>
            <span class="n">grad_func</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_grad</span><span class="p">(</span><span class="n">eq_constr</span><span class="p">[</span><span class="n">symbol</span><span class="p">][</span><span class="n">t</span><span class="p">],</span> <span class="n">vars_</span><span class="p">,</span>
                                           <span class="n">init</span><span class="p">,</span> <span class="n">poly</span><span class="p">)</span>
            <span class="n">constr_funcs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="p">{</span><span class="s1">'type'</span><span class="p">:</span> <span class="s1">'eq'</span><span class="p">,</span> <span class="s1">'fun'</span><span class="p">:</span> <span class="n">func</span><span class="p">,</span> <span class="s1">'jac'</span><span class="p">:</span> <span class="n">grad_func</span><span class="p">,</span>
                 <span class="s1">'args'</span><span class="p">:</span> <span class="kc">None</span><span class="p">},</span>
            <span class="p">)</span>

    <span class="k">return</span> <span class="n">cost_func</span><span class="p">,</span> <span class="n">cost_grad_func</span><span class="p">,</span> <span class="n">constr_funcs</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="ROAR.roar_autonomous_system.control_module.mpc_controller.VehicleMPCController.get_state0">
<code class="highlight language-python">
get_state0<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">cte</span><span class="p">,</span> <span class="n">epsi</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">delta</span><span class="p">,</span> <span class="n">poly</span><span class="p">)</span> </code>
<a class="headerlink" href="#ROAR.roar_autonomous_system.control_module.mpc_controller.VehicleMPCController.get_state0" title="Permanent link">¤</a></h3>
<div class="doc doc-contents">
<details class="quote">
<summary>Source code in <code>ROAR/roar_autonomous_system/control_module/mpc_controller.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">get_state0</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">cte</span><span class="p">,</span> <span class="n">epsi</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">delta</span><span class="p">,</span> <span class="n">poly</span><span class="p">):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">a</span> <span class="ow">or</span> <span class="mi">0</span>
    <span class="n">delta</span> <span class="o">=</span> <span class="n">delta</span> <span class="ow">or</span> <span class="mi">0</span>

    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">steps_ahead</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">poly</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
    <span class="n">psi</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">state0</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">steps_ahead</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">state0</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">steps_ahead</span><span class="p">:</span><span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">steps_ahead</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">state0</span><span class="p">[</span><span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">steps_ahead</span><span class="p">:</span><span class="mi">3</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">steps_ahead</span><span class="p">]</span> <span class="o">=</span> <span class="n">psi</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">state0</span><span class="p">[</span><span class="mi">3</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">steps_ahead</span><span class="p">:</span><span class="mi">4</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">steps_ahead</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">state0</span><span class="p">[</span><span class="mi">4</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">steps_ahead</span><span class="p">:</span><span class="mi">5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">steps_ahead</span><span class="p">]</span> <span class="o">=</span> <span class="n">cte</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">state0</span><span class="p">[</span><span class="mi">5</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">steps_ahead</span><span class="p">:</span><span class="mi">6</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">steps_ahead</span><span class="p">]</span> <span class="o">=</span> <span class="n">epsi</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">state0</span><span class="p">[</span><span class="mi">6</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">steps_ahead</span><span class="p">:</span><span class="mi">7</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">steps_ahead</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">state0</span><span class="p">[</span><span class="mi">7</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">steps_ahead</span><span class="p">:</span><span class="mi">8</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">steps_ahead</span><span class="p">]</span> <span class="o">=</span> <span class="n">delta</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">state0</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="ROAR.roar_autonomous_system.control_module.mpc_controller.VehicleMPCController.minimize_cost">
<code class="highlight language-python">
minimize_cost<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bounds</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">init</span><span class="p">)</span> </code>
<a class="headerlink" href="#ROAR.roar_autonomous_system.control_module.mpc_controller.VehicleMPCController.minimize_cost" title="Permanent link">¤</a></h3>
<div class="doc doc-contents">
<details class="quote">
<summary>Source code in <code>ROAR/roar_autonomous_system/control_module/mpc_controller.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>353
354
355
356
357
358
359
360
361
362
363
364
365
366</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">minimize_cost</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bounds</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">init</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">constr_func</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">constr_funcs</span><span class="p">:</span>
        <span class="n">constr_func</span><span class="p">[</span><span class="s1">'args'</span><span class="p">]</span> <span class="o">=</span> <span class="n">init</span>

    <span class="k">return</span> <span class="n">minimize</span><span class="p">(</span>
        <span class="n">fun</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cost_func</span><span class="p">,</span>
        <span class="n">x0</span><span class="o">=</span><span class="n">x0</span><span class="p">,</span>
        <span class="n">args</span><span class="o">=</span><span class="n">init</span><span class="p">,</span>
        <span class="n">jac</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cost_grad_func</span><span class="p">,</span>
        <span class="n">bounds</span><span class="o">=</span><span class="n">bounds</span><span class="p">,</span>
        <span class="n">constraints</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">constr_funcs</span><span class="p">,</span>
        <span class="n">method</span><span class="o">=</span><span class="s1">'SLSQP'</span><span class="p">,</span>
        <span class="n">tol</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tolerance</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="ROAR.roar_autonomous_system.control_module.mpc_controller.VehicleMPCController.run_step">
<code class="highlight language-python">
run_step<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vehicle</span><span class="p">,</span> <span class="n">next_waypoint</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> </code>
<a class="headerlink" href="#ROAR.roar_autonomous_system.control_module.mpc_controller.VehicleMPCController.run_step" title="Permanent link">¤</a></h3>
<div class="doc doc-contents">
<p>Abstract function for run step</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>vehicle</code></td>
<td><code>Vehicle</code></td>
<td>
<p>new vehicle state</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>next_waypoint</code></td>
<td><code>Transform</code></td>
<td>
<p>next waypoint</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>**kwargs</code></td>
<td><code></code></td>
<td></td>
<td><code>{}</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>VehicleControl</code></td>
<td>
<p>VehicleControl</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>ROAR/roar_autonomous_system/control_module/mpc_controller.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">run_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vehicle</span><span class="p">:</span> <span class="n">Vehicle</span><span class="p">,</span> <span class="n">next_waypoint</span><span class="p">:</span> <span class="n">Transform</span><span class="p">,</span>
             <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">VehicleControl</span><span class="p">:</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">VehicleMPCController</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">run_step</span><span class="p">(</span><span class="n">vehicle</span><span class="p">,</span> <span class="n">next_waypoint</span><span class="p">)</span>
    <span class="c1"># get vehicle location (x, y)</span>
    <span class="c1"># location = self.vehicle.transform.location</span>
    <span class="n">location</span> <span class="o">=</span> <span class="n">vehicle</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">location</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">location</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">location</span><span class="o">.</span><span class="n">y</span>
    <span class="c1"># get vehicle rotation</span>
    <span class="c1"># rotation = self.vehicle.transform.rotation</span>
    <span class="n">rotation</span> <span class="o">=</span> <span class="n">vehicle</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">rotation</span>
    <span class="n">ψ</span> <span class="o">=</span> <span class="n">rotation</span><span class="o">.</span><span class="n">yaw</span> <span class="o">/</span> <span class="mi">180</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>  <span class="c1"># transform into radient</span>
    <span class="n">cos_ψ</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">ψ</span><span class="p">)</span>
    <span class="n">sin_ψ</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">ψ</span><span class="p">)</span>
    <span class="c1"># get vehicle speed</span>
    <span class="c1"># v = Vehicle.get_speed(self.vehicle)</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">Vehicle</span><span class="o">.</span><span class="n">get_speed</span><span class="p">(</span><span class="n">vehicle</span><span class="p">)</span>
    <span class="c1"># get next waypoint location</span>
    <span class="n">wx</span><span class="p">,</span> <span class="n">wy</span> <span class="o">=</span> <span class="n">next_waypoint</span><span class="o">.</span><span class="n">location</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">next_waypoint</span><span class="o">.</span><span class="n">location</span><span class="o">.</span><span class="n">y</span>
    <span class="c1"># debug logging</span>
    <span class="c1"># self.logger.debug(f"car location:  ({x}, {y})")</span>
    <span class="c1"># self.logger.debug(f"car ψ: {ψ}")</span>
    <span class="c1"># self.logger.debug(f"car speed: {v}")</span>
    <span class="c1"># self.logger.debug(f"next waypoint: ({wx}, {wy})")</span>

    <span class="c1">### 3D ###</span>
    <span class="c1"># get the index of next waypoint</span>
    <span class="c1"># waypoint_index = self.get_closest_waypoint_index_3D(location,</span>
    <span class="c1"># next_waypoint.location)</span>
    <span class="c1"># # find more waypoints index to fit a polynomial</span>
    <span class="c1"># waypoint_index_shifted = waypoint_index - 2</span>
    <span class="c1"># indeces = waypoint_index_shifted + self.steps_poly * np.arange(</span>
    <span class="c1"># self.poly_degree + 1)</span>
    <span class="c1"># indeces = indeces % self.track_DF.shape[0]</span>
    <span class="c1"># # get waypoints for polynomial fitting</span>
    <span class="c1"># pts = np.array([[self.track_DF.iloc[i][0], self.track_DF.iloc[i][</span>
    <span class="c1"># 1]] for i in indeces])</span>

    <span class="c1">### 2D ###</span>
    <span class="n">index_2D</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_closest_waypoint_index_2D</span><span class="p">(</span><span class="n">location</span><span class="p">,</span>
                                                  <span class="n">next_waypoint</span><span class="o">.</span><span class="n">location</span><span class="p">)</span>
    <span class="n">index_2D_shifted</span> <span class="o">=</span> <span class="n">index_2D</span> <span class="o">-</span> <span class="mi">5</span>
    <span class="n">indeces_2D</span> <span class="o">=</span> <span class="n">index_2D_shifted</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">steps_poly</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">poly_degree</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">indeces_2D</span> <span class="o">=</span> <span class="n">indeces_2D</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">pts_2D</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">pts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pts_2D</span><span class="p">[</span><span class="n">indeces_2D</span><span class="p">]</span>

    <span class="c1"># self.logger.debug(f'\nwaypoint index:\n  {index_2D}')</span>
    <span class="c1"># self.logger.debug(f'\nindeces:\n  {indeces_2D}')</span>

    <span class="c1"># transform waypoints from world to car coorinate</span>
    <span class="n">pts_car</span> <span class="o">=</span> <span class="n">VehicleMPCController</span><span class="o">.</span><span class="n">transform_into_cars_coordinate_system</span><span class="p">(</span>
        <span class="n">pts</span><span class="p">,</span>
        <span class="n">x</span><span class="p">,</span>
        <span class="n">y</span><span class="p">,</span>
        <span class="n">cos_ψ</span><span class="p">,</span>
        <span class="n">sin_ψ</span>
    <span class="p">)</span>
    <span class="c1"># fit the polynomial</span>
    <span class="n">poly</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">pts_car</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">pts_car</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">poly_degree</span><span class="p">)</span>

    <span class="c1"># Debug</span>
    <span class="c1"># self.logger.debug(f'\nwaypoint index:\n  {waypoint_index}')</span>
    <span class="c1"># self.logger.debug(f'\nindeces:\n  {indeces}')</span>
    <span class="c1"># self.logger.debug(f'\npts for poly_fit:\n  {pts}')</span>
    <span class="c1"># self.logger.debug(f'\npts_car:\n  {pts_car}')</span>

    <span class="c1">###########</span>

    <span class="n">cte</span> <span class="o">=</span> <span class="n">poly</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">eψ</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">arctan</span><span class="p">(</span><span class="n">poly</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>

    <span class="n">init</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">cte</span><span class="p">,</span> <span class="n">eψ</span><span class="p">,</span> <span class="o">*</span><span class="n">poly</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">state0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_state0</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">cte</span><span class="p">,</span> <span class="n">eψ</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">steer</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">throttle</span><span class="p">,</span>
                                  <span class="n">poly</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">minimize_cost</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bounds</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">state0</span><span class="p">,</span> <span class="n">init</span><span class="p">)</span>

    <span class="c1"># self.steer = -0.6 * cte - 5.5 * (cte - self.prev_cte)</span>
    <span class="c1"># self.prev_cte = cte</span>
    <span class="c1"># self.throttle = VehicleMPCController.clip_throttle(self.throttle,</span>
    <span class="c1"># v, self.target_speed)</span>

    <span class="n">control</span> <span class="o">=</span> <span class="n">VehicleControl</span><span class="p">()</span>
    <span class="k">if</span> <span class="s1">'success'</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">message</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">steer</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">steps_ahead</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">throttle</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">steps_ahead</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">'Unsuccessful optimization'</span><span class="p">)</span>

    <span class="n">control</span><span class="o">.</span><span class="n">steering</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">steer</span>
    <span class="n">control</span><span class="o">.</span><span class="n">throttle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">throttle</span>

    <span class="k">return</span> <span class="n">control</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="ROAR.roar_autonomous_system.control_module.mpc_controller.VehicleMPCController.sync_data">
<code class="highlight language-python">
sync_data<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vehicle</span><span class="p">)</span> </code>
<a class="headerlink" href="#ROAR.roar_autonomous_system.control_module.mpc_controller.VehicleMPCController.sync_data" title="Permanent link">¤</a></h3>
<div class="doc doc-contents">
<p>default sync data function</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>vehicle</code></td>
<td><code></code></td>
<td>
<p>new vehicle state</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>None</code></td>
<td>
<p>None</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>ROAR/roar_autonomous_system/control_module/mpc_controller.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>208
209</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">sync_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vehicle</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">VehicleMPCController</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">sync_data</span><span class="p">(</span><span class="n">vehicle</span><span class="o">=</span><span class="n">vehicle</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="ROAR.roar_autonomous_system.control_module.mpc_controller.VehicleMPCController.transform_into_cars_coordinate_system">
<code class="highlight language-python">
transform_into_cars_coordinate_system<span class="p">(</span><span class="n">pts</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cos_ψ</span><span class="p">,</span> <span class="n">sin_ψ</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
</span>
<a class="headerlink" href="#ROAR.roar_autonomous_system.control_module.mpc_controller.VehicleMPCController.transform_into_cars_coordinate_system" title="Permanent link">¤</a></h3>
<div class="doc doc-contents">
<details class="quote">
<summary>Source code in <code>ROAR/roar_autonomous_system/control_module/mpc_controller.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>402
403
404
405
406
407
408</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">transform_into_cars_coordinate_system</span><span class="p">(</span><span class="n">pts</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cos_ψ</span><span class="p">,</span> <span class="n">sin_ψ</span><span class="p">):</span>
    <span class="n">diff</span> <span class="o">=</span> <span class="p">(</span><span class="n">pts</span> <span class="o">-</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">])</span>
    <span class="n">pts_car</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">diff</span><span class="p">)</span>
    <span class="n">pts_car</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">cos_ψ</span> <span class="o">*</span> <span class="n">diff</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">sin_ψ</span> <span class="o">*</span> <span class="n">diff</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">pts_car</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">sin_ψ</span> <span class="o">*</span> <span class="n">diff</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">cos_ψ</span> <span class="o">*</span> <span class="n">diff</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">pts_car</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<div class="doc doc-contents first">
<p>This module contains PID controllers to perform lateral and longitudinal control. </p>
<div class="doc doc-children">
<div class="doc doc-object doc-attribute">
<h2 class="doc doc-heading" id="ROAR.roar_autonomous_system.control_module.pid_controller.OPTIMIZED_LATERAL_PID_VALUES">
<code class="highlight">
OPTIMIZED_LATERAL_PID_VALUES        </code>
<a class="headerlink" href="#ROAR.roar_autonomous_system.control_module.pid_controller.OPTIMIZED_LATERAL_PID_VALUES" title="Permanent link">¤</a></h2>
<div class="doc doc-contents">
</div>
</div>
<div class="doc doc-object doc-class">
<h2 class="doc doc-heading" id="ROAR.roar_autonomous_system.control_module.pid_controller.PIDLateralController">
<code>PIDLateralController</code>
<a class="headerlink" href="#ROAR.roar_autonomous_system.control_module.pid_controller.PIDLateralController" title="Permanent link">¤</a></h2>
<div class="doc doc-contents">
<p>PIDLateralController implements lateral control using a PID.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="ROAR.roar_autonomous_system.control_module.pid_controller.PIDLateralController.__init__">
<code class="highlight language-python">
__init__<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vehicle</span><span class="p">,</span> <span class="n">K_P</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">K_D</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">K_I</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">0.03</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#ROAR.roar_autonomous_system.control_module.pid_controller.PIDLateralController.__init__" title="Permanent link">¤</a></h3>
<div class="doc doc-contents">
<p>Constructor method.
    :param vehicle: actor to apply to local planner logic onto
    :param K_P: Proportional term
    :param K_D: Differential term
    :param K_I: Integral term
    :param dt: time differential in seconds</p>
<details class="quote">
<summary>Source code in <code>ROAR/roar_autonomous_system/control_module/pid_controller.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>228
229
230
231
232
233
234
235
236
237
238
239
240
241
242</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vehicle</span><span class="p">,</span> <span class="n">K_P</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">K_D</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">K_I</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">0.03</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Constructor method.</span>
<span class="sd">        :param vehicle: actor to apply to local planner logic onto</span>
<span class="sd">        :param K_P: Proportional term</span>
<span class="sd">        :param K_D: Differential term</span>
<span class="sd">        :param K_I: Integral term</span>
<span class="sd">        :param dt: time differential in seconds</span>
<span class="sd">    """</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">vehicle</span><span class="p">:</span> <span class="n">Vehicle</span> <span class="o">=</span> <span class="n">vehicle</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">k_p</span> <span class="o">=</span> <span class="n">K_P</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">k_d</span> <span class="o">=</span> <span class="n">K_D</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">k_i</span> <span class="o">=</span> <span class="n">K_I</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dt</span> <span class="o">=</span> <span class="n">dt</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_e_buffer</span> <span class="o">=</span> <span class="n">deque</span><span class="p">(</span><span class="n">maxlen</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="ROAR.roar_autonomous_system.control_module.pid_controller.PIDLateralController.run_step">
<code class="highlight language-python">
run_step<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target_waypoint</span><span class="p">)</span> </code>
<a class="headerlink" href="#ROAR.roar_autonomous_system.control_module.pid_controller.PIDLateralController.run_step" title="Permanent link">¤</a></h3>
<div class="doc doc-contents">
<p>Execute one step of lateral control to steer
the vehicle towards a certain waypoin.
    :param target_waypoint:
    :return: steering control in the range [-1, 1] where:
    -1 maximum steering to left
    +1 maximum steering to right</p>
<details class="quote">
<summary>Source code in <code>ROAR/roar_autonomous_system/control_module/pid_controller.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>244
245
246
247
248
249
250
251
252
253
254
255</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">run_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target_waypoint</span><span class="p">:</span> <span class="n">Transform</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="sd">"""</span>
<span class="sd">    Execute one step of lateral control to steer</span>
<span class="sd">    the vehicle towards a certain waypoin.</span>
<span class="sd">        :param target_waypoint:</span>
<span class="sd">        :return: steering control in the range [-1, 1] where:</span>
<span class="sd">        -1 maximum steering to left</span>
<span class="sd">        +1 maximum steering to right</span>
<span class="sd">    """</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pid_control</span><span class="p">(</span>
        <span class="n">target_waypoint</span><span class="o">=</span><span class="n">target_waypoint</span><span class="p">,</span> <span class="n">vehicle_transform</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">vehicle</span><span class="o">.</span><span class="n">transform</span>
    <span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h2 class="doc doc-heading" id="ROAR.roar_autonomous_system.control_module.pid_controller.PIDLongitudinalController">
<code>PIDLongitudinalController</code>
<a class="headerlink" href="#ROAR.roar_autonomous_system.control_module.pid_controller.PIDLongitudinalController" title="Permanent link">¤</a></h2>
<div class="doc doc-contents">
<p>PIDLongitudinalController implements longitudinal control using a PID.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="ROAR.roar_autonomous_system.control_module.pid_controller.PIDLongitudinalController.__init__">
<code class="highlight language-python">
__init__<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vehicle</span><span class="p">,</span> <span class="n">K_P</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">K_D</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">K_I</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">0.03</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#ROAR.roar_autonomous_system.control_module.pid_controller.PIDLongitudinalController.__init__" title="Permanent link">¤</a></h3>
<div class="doc doc-contents">
<p>Constructor method.
    :param vehicle: actor to apply to local planner logic onto
    :param K_P: Proportional term
    :param K_D: Differential term
    :param K_I: Integral term
    :param dt: time differential in seconds</p>
<details class="quote">
<summary>Source code in <code>ROAR/roar_autonomous_system/control_module/pid_controller.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>172
173
174
175
176
177
178
179
180
181
182
183
184
185
186</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vehicle</span><span class="p">:</span> <span class="n">Vehicle</span><span class="p">,</span> <span class="n">K_P</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">K_D</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">K_I</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">0.03</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Constructor method.</span>
<span class="sd">        :param vehicle: actor to apply to local planner logic onto</span>
<span class="sd">        :param K_P: Proportional term</span>
<span class="sd">        :param K_D: Differential term</span>
<span class="sd">        :param K_I: Integral term</span>
<span class="sd">        :param dt: time differential in seconds</span>
<span class="sd">    """</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">vehicle</span> <span class="o">=</span> <span class="n">vehicle</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_k_p</span> <span class="o">=</span> <span class="n">K_P</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_k_d</span> <span class="o">=</span> <span class="n">K_D</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_k_i</span> <span class="o">=</span> <span class="n">K_I</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_dt</span> <span class="o">=</span> <span class="n">dt</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_error_buffer</span> <span class="o">=</span> <span class="n">deque</span><span class="p">(</span><span class="n">maxlen</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="ROAR.roar_autonomous_system.control_module.pid_controller.PIDLongitudinalController.run_step">
<code class="highlight language-python">
run_step<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target_speed</span><span class="p">)</span> </code>
<a class="headerlink" href="#ROAR.roar_autonomous_system.control_module.pid_controller.PIDLongitudinalController.run_step" title="Permanent link">¤</a></h3>
<div class="doc doc-contents">
<p>Execute one step of longitudinal control to reach a given target speed.
    :param target_speed: target speed in Km/h
    :return: throttle control</p>
<details class="quote">
<summary>Source code in <code>ROAR/roar_autonomous_system/control_module/pid_controller.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>188
189
190
191
192
193
194
195</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">run_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target_speed</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Execute one step of longitudinal control to reach a given target speed.</span>
<span class="sd">        :param target_speed: target speed in Km/h</span>
<span class="sd">        :return: throttle control</span>
<span class="sd">    """</span>
    <span class="n">current_speed</span> <span class="o">=</span> <span class="n">Vehicle</span><span class="o">.</span><span class="n">get_speed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vehicle</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pid_control</span><span class="p">(</span><span class="n">target_speed</span><span class="p">,</span> <span class="n">current_speed</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h2 class="doc doc-heading" id="ROAR.roar_autonomous_system.control_module.pid_controller.PIDParam">
<code>PIDParam</code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-pydantic-model"><code>pydantic-model</code></small>
</span>
<a class="headerlink" href="#ROAR.roar_autonomous_system.control_module.pid_controller.PIDParam" title="Permanent link">¤</a></h2>
<div class="doc doc-contents">
<div class="doc doc-children">
<div class="doc doc-object doc-attribute">
<h3 class="doc doc-heading" id="ROAR.roar_autonomous_system.control_module.pid_controller.PIDParam.dt">
<code class="highlight">
dt: <span class="nb">float</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
</span>
<a class="headerlink" href="#ROAR.roar_autonomous_system.control_module.pid_controller.PIDParam.dt" title="Permanent link">¤</a></h3>
<div class="doc doc-contents">
</div>
</div>
<div class="doc doc-object doc-attribute">
<h3 class="doc doc-heading" id="ROAR.roar_autonomous_system.control_module.pid_controller.PIDParam.K_D">
<code class="highlight">
K_D: <span class="nb">float</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
</span>
<a class="headerlink" href="#ROAR.roar_autonomous_system.control_module.pid_controller.PIDParam.K_D" title="Permanent link">¤</a></h3>
<div class="doc doc-contents">
</div>
</div>
<div class="doc doc-object doc-attribute">
<h3 class="doc doc-heading" id="ROAR.roar_autonomous_system.control_module.pid_controller.PIDParam.K_I">
<code class="highlight">
K_I: <span class="nb">float</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
</span>
<a class="headerlink" href="#ROAR.roar_autonomous_system.control_module.pid_controller.PIDParam.K_I" title="Permanent link">¤</a></h3>
<div class="doc doc-contents">
</div>
</div>
<div class="doc doc-object doc-attribute">
<h3 class="doc doc-heading" id="ROAR.roar_autonomous_system.control_module.pid_controller.PIDParam.K_P">
<code class="highlight">
K_P: <span class="nb">float</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-pydantic-field"><code>pydantic-field</code></small>
</span>
<a class="headerlink" href="#ROAR.roar_autonomous_system.control_module.pid_controller.PIDParam.K_P" title="Permanent link">¤</a></h3>
<div class="doc doc-contents">
</div>
</div>
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="ROAR.roar_autonomous_system.control_module.pid_controller.PIDParam.__config__">
<code>__config__</code>
<a class="headerlink" href="#ROAR.roar_autonomous_system.control_module.pid_controller.PIDParam.__config__" title="Permanent link">¤</a></h3>
<div class="doc doc-contents">
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="ROAR.roar_autonomous_system.control_module.pid_controller.PIDParam.__json_encoder__">
<code class="highlight language-python">
__json_encoder__<span class="p">(</span><span class="n">obj</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
<small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
</span>
<a class="headerlink" href="#ROAR.roar_autonomous_system.control_module.pid_controller.PIDParam.__json_encoder__" title="Permanent link">¤</a></h3>
<div class="doc doc-contents">
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="ROAR.roar_autonomous_system.control_module.pid_controller.PIDParam.default_lateral_param">
<code class="highlight language-python">
default_lateral_param<span class="p">()</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
</span>
<a class="headerlink" href="#ROAR.roar_autonomous_system.control_module.pid_controller.PIDParam.default_lateral_param" title="Permanent link">¤</a></h3>
<div class="doc doc-contents">
<details class="quote">
<summary>Source code in <code>ROAR/roar_autonomous_system/control_module/pid_controller.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>30
31
32</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">default_lateral_param</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">PIDParam</span><span class="p">(</span><span class="n">K_P</span><span class="o">=</span><span class="mf">1.95</span><span class="p">,</span> <span class="n">K_D</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">K_I</span><span class="o">=</span><span class="mf">0.07</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">1.0</span> <span class="o">/</span> <span class="mf">20.0</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="ROAR.roar_autonomous_system.control_module.pid_controller.PIDParam.default_longitudinal_param">
<code class="highlight language-python">
default_longitudinal_param<span class="p">()</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
</span>
<a class="headerlink" href="#ROAR.roar_autonomous_system.control_module.pid_controller.PIDParam.default_longitudinal_param" title="Permanent link">¤</a></h3>
<div class="doc doc-contents">
<details class="quote">
<summary>Source code in <code>ROAR/roar_autonomous_system/control_module/pid_controller.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>34
35
36</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">default_longitudinal_param</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">PIDParam</span><span class="p">(</span><span class="n">K_P</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">K_D</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">K_I</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">1.0</span> <span class="o">/</span> <span class="mf">20.0</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h2 class="doc doc-heading" id="ROAR.roar_autonomous_system.control_module.pid_controller.VehiclePIDController">
<code>VehiclePIDController</code>
<a class="headerlink" href="#ROAR.roar_autonomous_system.control_module.pid_controller.VehiclePIDController" title="Permanent link">¤</a></h2>
<div class="doc doc-contents">
<p>VehiclePIDController is the combination of two PID controllers
(lateral and longitudinal) to perform the
low level control a vehicle from client side</p>
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="ROAR.roar_autonomous_system.control_module.pid_controller.VehiclePIDController.__init__">
<code class="highlight language-python">
__init__<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vehicle</span><span class="p">,</span> <span class="n">args_lateral</span><span class="p">,</span> <span class="n">args_longitudinal</span><span class="p">,</span> <span class="n">target_speed</span><span class="o">=</span><span class="n">inf</span><span class="p">,</span> <span class="n">max_throttle</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_steering</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#ROAR.roar_autonomous_system.control_module.pid_controller.VehiclePIDController.__init__" title="Permanent link">¤</a></h3>
<div class="doc doc-contents">
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>vehicle</code></td>
<td><code>Vehicle</code></td>
<td>
<p>actor to apply to local planner logic onto</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>args_lateral</code></td>
<td><code>PIDParam</code></td>
<td>
<p>dictionary of arguments to set the lateral PID control</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>args_longitudinal</code></td>
<td><code>PIDParam</code></td>
<td>
<p>dictionary of arguments to set the longitudinal</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>target_speed</code></td>
<td><code></code></td>
<td>
<p>target speedd in km/h</p>
</td>
<td><code>inf</code></td>
</tr>
<tr>
<td><code>max_throttle</code></td>
<td><code></code></td>
<td>
<p>maximum throttle from, will be capped at 1</p>
</td>
<td><code>1</code></td>
</tr>
<tr>
<td><code>max_steering</code></td>
<td><code></code></td>
<td>
<p>absolute maximum steering ranging from -1 - 1</p>
</td>
<td><code>1</code></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>ROAR/roar_autonomous_system/control_module/pid_controller.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">vehicle</span><span class="p">:</span> <span class="n">Vehicle</span><span class="p">,</span>
    <span class="n">args_lateral</span><span class="p">:</span> <span class="n">PIDParam</span><span class="p">,</span>
    <span class="n">args_longitudinal</span><span class="p">:</span> <span class="n">PIDParam</span><span class="p">,</span>
    <span class="n">target_speed</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="s2">"inf"</span><span class="p">),</span>
    <span class="n">max_throttle</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">max_steering</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">"""</span>

<span class="sd">    Args:</span>
<span class="sd">        vehicle: actor to apply to local planner logic onto</span>
<span class="sd">        args_lateral:  dictionary of arguments to set the lateral PID control</span>
<span class="sd">        args_longitudinal: dictionary of arguments to set the longitudinal</span>
<span class="sd">        target_speed: target speedd in km/h</span>
<span class="sd">        max_throttle: maximum throttle from, will be capped at 1</span>
<span class="sd">        max_steering: absolute maximum steering ranging from -1 - 1</span>
<span class="sd">    """</span>

    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">vehicle</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">max_throttle</span> <span class="o">=</span> <span class="n">max_throttle</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">max_steer</span> <span class="o">=</span> <span class="n">max_steering</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">target_speed</span> <span class="o">=</span> <span class="n">target_speed</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">past_steering</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vehicle</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">steering</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_lon_controller</span> <span class="o">=</span> <span class="n">PIDLongitudinalController</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vehicle</span><span class="p">,</span>
        <span class="n">K_P</span><span class="o">=</span><span class="n">args_longitudinal</span><span class="o">.</span><span class="n">K_P</span><span class="p">,</span>
        <span class="n">K_D</span><span class="o">=</span><span class="n">args_longitudinal</span><span class="o">.</span><span class="n">K_D</span><span class="p">,</span>
        <span class="n">K_I</span><span class="o">=</span><span class="n">args_longitudinal</span><span class="o">.</span><span class="n">K_I</span><span class="p">,</span>
        <span class="n">dt</span><span class="o">=</span><span class="n">args_longitudinal</span><span class="o">.</span><span class="n">dt</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_lat_controller</span> <span class="o">=</span> <span class="n">PIDLateralController</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vehicle</span><span class="p">,</span>
        <span class="n">K_P</span><span class="o">=</span><span class="n">args_lateral</span><span class="o">.</span><span class="n">K_P</span><span class="p">,</span>
        <span class="n">K_D</span><span class="o">=</span><span class="n">args_lateral</span><span class="o">.</span><span class="n">K_D</span><span class="p">,</span>
        <span class="n">K_I</span><span class="o">=</span><span class="n">args_lateral</span><span class="o">.</span><span class="n">K_I</span><span class="p">,</span>
        <span class="n">dt</span><span class="o">=</span><span class="n">args_lateral</span><span class="o">.</span><span class="n">dt</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">"PID Controller initiated"</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="ROAR.roar_autonomous_system.control_module.pid_controller.VehiclePIDController.run_step">
<code class="highlight language-python">
run_step<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vehicle</span><span class="p">,</span> <span class="n">next_waypoint</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> </code>
<a class="headerlink" href="#ROAR.roar_autonomous_system.control_module.pid_controller.VehiclePIDController.run_step" title="Permanent link">¤</a></h3>
<div class="doc doc-contents">
<p>Execute one step of control invoking both lateral and longitudinal
PID controllers to reach a target waypoint at a given target_speed.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>vehicle</code></td>
<td><code>Vehicle</code></td>
<td>
<p>New vehicle state</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>next_waypoint</code></td>
<td><code>Transform</code></td>
<td>
<p>target location encoded as a waypoint</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>**kwargs</code></td>
<td><code></code></td>
<td></td>
<td><code>{}</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>VehicleControl</code></td>
<td>
<p>Next Vehicle Control</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>ROAR/roar_autonomous_system/control_module/pid_controller.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span> 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">run_step</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">vehicle</span><span class="p">:</span> <span class="n">Vehicle</span><span class="p">,</span> <span class="n">next_waypoint</span><span class="p">:</span> <span class="n">Transform</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">VehicleControl</span><span class="p">:</span>
    <span class="sd">"""</span>
<span class="sd">    Execute one step of control invoking both lateral and longitudinal</span>
<span class="sd">    PID controllers to reach a target waypoint at a given target_speed.</span>

<span class="sd">    Args:</span>
<span class="sd">        vehicle: New vehicle state</span>
<span class="sd">        next_waypoint:  target location encoded as a waypoint</span>
<span class="sd">        **kwargs:</span>

<span class="sd">    Returns:</span>
<span class="sd">        Next Vehicle Control</span>
<span class="sd">    """</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">VehiclePIDController</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">run_step</span><span class="p">(</span><span class="n">vehicle</span><span class="p">,</span> <span class="n">next_waypoint</span><span class="p">)</span>
    <span class="n">curr_speed</span> <span class="o">=</span> <span class="n">Vehicle</span><span class="o">.</span><span class="n">get_speed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vehicle</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">curr_speed</span> <span class="o">&lt;</span> <span class="mi">60</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lat_controller</span><span class="o">.</span><span class="n">k_d</span> <span class="o">=</span> <span class="n">OPTIMIZED_LATERAL_PID_VALUES</span><span class="p">[</span><span class="mi">60</span><span class="p">]</span><span class="o">.</span><span class="n">K_D</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lat_controller</span><span class="o">.</span><span class="n">k_i</span> <span class="o">=</span> <span class="n">OPTIMIZED_LATERAL_PID_VALUES</span><span class="p">[</span><span class="mi">60</span><span class="p">]</span><span class="o">.</span><span class="n">K_I</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lat_controller</span><span class="o">.</span><span class="n">k_p</span> <span class="o">=</span> <span class="n">OPTIMIZED_LATERAL_PID_VALUES</span><span class="p">[</span><span class="mi">60</span><span class="p">]</span><span class="o">.</span><span class="n">K_P</span>
    <span class="k">elif</span> <span class="n">curr_speed</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lat_controller</span><span class="o">.</span><span class="n">k_d</span> <span class="o">=</span> <span class="n">OPTIMIZED_LATERAL_PID_VALUES</span><span class="p">[</span><span class="mi">100</span><span class="p">]</span><span class="o">.</span><span class="n">K_D</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lat_controller</span><span class="o">.</span><span class="n">k_i</span> <span class="o">=</span> <span class="n">OPTIMIZED_LATERAL_PID_VALUES</span><span class="p">[</span><span class="mi">100</span><span class="p">]</span><span class="o">.</span><span class="n">K_I</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lat_controller</span><span class="o">.</span><span class="n">k_p</span> <span class="o">=</span> <span class="n">OPTIMIZED_LATERAL_PID_VALUES</span><span class="p">[</span><span class="mi">100</span><span class="p">]</span><span class="o">.</span><span class="n">K_P</span>
    <span class="k">elif</span> <span class="n">curr_speed</span> <span class="o">&lt;</span> <span class="mi">150</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lat_controller</span><span class="o">.</span><span class="n">k_d</span> <span class="o">=</span> <span class="n">OPTIMIZED_LATERAL_PID_VALUES</span><span class="p">[</span><span class="mi">150</span><span class="p">]</span><span class="o">.</span><span class="n">K_D</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lat_controller</span><span class="o">.</span><span class="n">k_i</span> <span class="o">=</span> <span class="n">OPTIMIZED_LATERAL_PID_VALUES</span><span class="p">[</span><span class="mi">150</span><span class="p">]</span><span class="o">.</span><span class="n">K_I</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lat_controller</span><span class="o">.</span><span class="n">k_p</span> <span class="o">=</span> <span class="n">OPTIMIZED_LATERAL_PID_VALUES</span><span class="p">[</span><span class="mi">150</span><span class="p">]</span><span class="o">.</span><span class="n">K_P</span>

    <span class="n">acceptable_target_speed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_speed</span>
    <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vehicle</span><span class="o">.</span><span class="n">control</span><span class="o">.</span><span class="n">steering</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.05</span><span class="p">:</span>
        <span class="n">acceptable_target_speed</span> <span class="o">+=</span> <span class="mi">20</span>  <span class="c1"># eco boost</span>

    <span class="n">acceleration</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lon_controller</span><span class="o">.</span><span class="n">run_step</span><span class="p">(</span><span class="n">acceptable_target_speed</span><span class="p">)</span>
    <span class="n">current_steering</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lat_controller</span><span class="o">.</span><span class="n">run_step</span><span class="p">(</span><span class="n">next_waypoint</span><span class="p">)</span>
    <span class="n">control</span> <span class="o">=</span> <span class="n">VehicleControl</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">acceleration</span> <span class="o">&gt;=</span> <span class="mf">0.0</span><span class="p">:</span>
        <span class="n">control</span><span class="o">.</span><span class="n">throttle</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">acceleration</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_throttle</span><span class="p">)</span>
        <span class="c1"># control.brake = 0.0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">control</span><span class="o">.</span><span class="n">throttle</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1"># control.brake = min(abs(acceleration), self.max_brake)</span>

    <span class="c1"># Steering regulation: changes cannot happen abruptly, can't steer too much.</span>
    <span class="k">if</span> <span class="n">current_steering</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">past_steering</span> <span class="o">+</span> <span class="mf">0.1</span><span class="p">:</span>
        <span class="n">current_steering</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">past_steering</span> <span class="o">+</span> <span class="mf">0.1</span>
    <span class="k">elif</span> <span class="n">current_steering</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">past_steering</span> <span class="o">-</span> <span class="mf">0.1</span><span class="p">:</span>
        <span class="n">current_steering</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">past_steering</span> <span class="o">-</span> <span class="mf">0.1</span>

    <span class="k">if</span> <span class="n">current_steering</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">steering</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_steer</span><span class="p">,</span> <span class="n">current_steering</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">steering</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">max_steer</span><span class="p">,</span> <span class="n">current_steering</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">current_steering</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.03</span> <span class="ow">and</span> <span class="n">curr_speed</span> <span class="o">&gt;</span> <span class="mi">110</span><span class="p">:</span>
        <span class="c1"># if i am doing a sharp (&gt;0.5) turn, i do not want to step on full gas</span>
        <span class="n">control</span><span class="o">.</span><span class="n">throttle</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>

    <span class="n">control</span><span class="o">.</span><span class="n">steering</span> <span class="o">=</span> <span class="n">steering</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">past_steering</span> <span class="o">=</span> <span class="n">steering</span>
    <span class="k">return</span> <span class="n">control</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="ROAR.roar_autonomous_system.control_module.pid_controller.VehiclePIDController.sync_data">
<code class="highlight language-python">
sync_data<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vehicle</span><span class="p">)</span> </code>
<a class="headerlink" href="#ROAR.roar_autonomous_system.control_module.pid_controller.VehiclePIDController.sync_data" title="Permanent link">¤</a></h3>
<div class="doc doc-contents">
<p>default sync data function</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>vehicle</code></td>
<td><code></code></td>
<td>
<p>new vehicle state</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>None</code></td>
<td>
<p>None</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>ROAR/roar_autonomous_system/control_module/pid_controller.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>161
162
163
164</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">sync_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vehicle</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">VehiclePIDController</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">sync_data</span><span class="p">(</span><span class="n">vehicle</span><span class="o">=</span><span class="n">vehicle</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_lon_controller</span><span class="o">.</span><span class="n">vehicle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vehicle</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_lat_controller</span><span class="o">.</span><span class="n">vehicle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vehicle</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<div class="doc doc-contents first">
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h2 class="doc doc-heading" id="ROAR.roar_autonomous_system.control_module.pure_pursuit_control.LatitunalPurePursuitController">
<code>LatitunalPurePursuitController</code>
<a class="headerlink" href="#ROAR.roar_autonomous_system.control_module.pure_pursuit_control.LatitunalPurePursuitController" title="Permanent link">¤</a></h2>
<div class="doc doc-contents">
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="ROAR.roar_autonomous_system.control_module.pure_pursuit_control.LatitunalPurePursuitController.__init__">
<code class="highlight language-python">
__init__<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vehicle</span><span class="p">,</span> <span class="n">look_ahead_gain</span><span class="p">,</span> <span class="n">look_ahead_distance</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#ROAR.roar_autonomous_system.control_module.pure_pursuit_control.LatitunalPurePursuitController.__init__" title="Permanent link">¤</a></h3>
<div class="doc doc-contents">
<details class="quote">
<summary>Source code in <code>ROAR/roar_autonomous_system/control_module/pure_pursuit_control.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span> 95
 96
 97
 98
 99
100
101</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">vehicle</span><span class="p">:</span> <span class="n">Vehicle</span><span class="p">,</span> <span class="n">look_ahead_gain</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">look_ahead_distance</span><span class="p">:</span> <span class="nb">float</span>
<span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">vehicle</span> <span class="o">=</span> <span class="n">vehicle</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">look_ahead_gain</span> <span class="o">=</span> <span class="n">look_ahead_gain</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">look_ahead_distance</span> <span class="o">=</span> <span class="n">look_ahead_distance</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="ROAR.roar_autonomous_system.control_module.pure_pursuit_control.LatitunalPurePursuitController.run_step">
<code class="highlight language-python">
run_step<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vehicle</span><span class="p">,</span> <span class="n">next_waypoint</span><span class="p">)</span> </code>
<a class="headerlink" href="#ROAR.roar_autonomous_system.control_module.pure_pursuit_control.LatitunalPurePursuitController.run_step" title="Permanent link">¤</a></h3>
<div class="doc doc-contents">
<details class="quote">
<summary>Source code in <code>ROAR/roar_autonomous_system/control_module/pure_pursuit_control.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">run_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vehicle</span><span class="p">:</span> <span class="n">Vehicle</span><span class="p">,</span> <span class="n">next_waypoint</span><span class="p">:</span> <span class="n">Transform</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">sync</span><span class="p">(</span><span class="n">vehicle</span><span class="o">=</span><span class="n">vehicle</span><span class="p">)</span>
    <span class="n">target_y</span> <span class="o">=</span> <span class="n">next_waypoint</span><span class="o">.</span><span class="n">location</span><span class="o">.</span><span class="n">y</span>
    <span class="n">target_x</span> <span class="o">=</span> <span class="n">next_waypoint</span><span class="o">.</span><span class="n">location</span><span class="o">.</span><span class="n">x</span>
    <span class="n">angle_difference</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">atan2</span><span class="p">(</span>
        <span class="n">target_y</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">vehicle</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">location</span><span class="o">.</span><span class="n">y</span><span class="p">,</span>
        <span class="n">target_x</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">vehicle</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">location</span><span class="o">.</span><span class="n">x</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vehicle</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">rotation</span><span class="o">.</span><span class="n">yaw</span><span class="p">)</span>
    <span class="n">curr_look_forward</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">look_ahead_gain</span> <span class="o">*</span> <span class="n">Vehicle</span><span class="o">.</span><span class="n">get_speed</span><span class="p">(</span><span class="n">vehicle</span><span class="o">=</span><span class="n">vehicle</span><span class="p">)</span>
            <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">look_ahead_distance</span>
    <span class="p">)</span>
    <span class="n">lateral_difference</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">atan2</span><span class="p">(</span>
        <span class="mf">2.0</span>
        <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">vehicle</span><span class="o">.</span><span class="n">wheel_base</span>
        <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">angle_difference</span><span class="p">)</span>
        <span class="o">/</span> <span class="n">curr_look_forward</span><span class="p">,</span>
        <span class="mf">1.0</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">VehicleControl</span><span class="o">.</span><span class="n">clamp</span><span class="p">(</span><span class="n">lateral_difference</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="ROAR.roar_autonomous_system.control_module.pure_pursuit_control.LatitunalPurePursuitController.sync">
<code class="highlight language-python">
sync<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vehicle</span><span class="p">)</span> </code>
<a class="headerlink" href="#ROAR.roar_autonomous_system.control_module.pure_pursuit_control.LatitunalPurePursuitController.sync" title="Permanent link">¤</a></h3>
<div class="doc doc-contents">
<details class="quote">
<summary>Source code in <code>ROAR/roar_autonomous_system/control_module/pure_pursuit_control.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>124
125</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">sync</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vehicle</span><span class="p">:</span> <span class="n">Vehicle</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">vehicle</span> <span class="o">=</span> <span class="n">vehicle</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h2 class="doc doc-heading" id="ROAR.roar_autonomous_system.control_module.pure_pursuit_control.LongitunalPurePursuitController">
<code>LongitunalPurePursuitController</code>
<a class="headerlink" href="#ROAR.roar_autonomous_system.control_module.pure_pursuit_control.LongitunalPurePursuitController" title="Permanent link">¤</a></h2>
<div class="doc doc-contents">
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="ROAR.roar_autonomous_system.control_module.pure_pursuit_control.LongitunalPurePursuitController.__init__">
<code class="highlight language-python">
__init__<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vehicle</span><span class="p">,</span> <span class="n">target_speed</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">kp</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#ROAR.roar_autonomous_system.control_module.pure_pursuit_control.LongitunalPurePursuitController.__init__" title="Permanent link">¤</a></h3>
<div class="doc doc-contents">
<details class="quote">
<summary>Source code in <code>ROAR/roar_autonomous_system/control_module/pure_pursuit_control.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>76
77
78
79</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vehicle</span><span class="p">:</span> <span class="n">Vehicle</span><span class="p">,</span> <span class="n">target_speed</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">kp</span><span class="o">=</span><span class="mf">0.1</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">vehicle</span> <span class="o">=</span> <span class="n">vehicle</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">target_speed</span> <span class="o">=</span> <span class="n">target_speed</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">kp</span> <span class="o">=</span> <span class="n">kp</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="ROAR.roar_autonomous_system.control_module.pure_pursuit_control.LongitunalPurePursuitController.run_step">
<code class="highlight language-python">
run_step<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vehicle</span><span class="p">)</span> </code>
<a class="headerlink" href="#ROAR.roar_autonomous_system.control_module.pure_pursuit_control.LongitunalPurePursuitController.run_step" title="Permanent link">¤</a></h3>
<div class="doc doc-contents">
<details class="quote">
<summary>Source code in <code>ROAR/roar_autonomous_system/control_module/pure_pursuit_control.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>81
82
83
84
85
86
87
88</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">run_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vehicle</span><span class="p">:</span> <span class="n">Vehicle</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">sync</span><span class="p">(</span><span class="n">vehicle</span><span class="o">=</span><span class="n">vehicle</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">float</span><span class="p">(</span>
        <span class="n">VehicleControl</span><span class="o">.</span><span class="n">clamp</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">kp</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">target_speed</span> <span class="o">-</span> <span class="n">Vehicle</span><span class="o">.</span><span class="n">get_speed</span><span class="p">(</span><span class="n">vehicle</span><span class="p">)),</span> <span class="mi">0</span><span class="p">,</span>
            <span class="mi">1</span>
        <span class="p">)</span>
    <span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="ROAR.roar_autonomous_system.control_module.pure_pursuit_control.LongitunalPurePursuitController.sync">
<code class="highlight language-python">
sync<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vehicle</span><span class="p">)</span> </code>
<a class="headerlink" href="#ROAR.roar_autonomous_system.control_module.pure_pursuit_control.LongitunalPurePursuitController.sync" title="Permanent link">¤</a></h3>
<div class="doc doc-contents">
<details class="quote">
<summary>Source code in <code>ROAR/roar_autonomous_system/control_module/pure_pursuit_control.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>90
91</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">sync</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vehicle</span><span class="p">:</span> <span class="n">Vehicle</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">vehicle</span> <span class="o">=</span> <span class="n">vehicle</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h2 class="doc doc-heading" id="ROAR.roar_autonomous_system.control_module.pure_pursuit_control.PurePursuitController">
<code>PurePursuitController</code>
<a class="headerlink" href="#ROAR.roar_autonomous_system.control_module.pure_pursuit_control.PurePursuitController" title="Permanent link">¤</a></h2>
<div class="doc doc-contents">
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="ROAR.roar_autonomous_system.control_module.pure_pursuit_control.PurePursuitController.__init__">
<code class="highlight language-python">
__init__<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vehicle</span><span class="p">,</span> <span class="n">look_ahead_gain</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">look_ahead_distance</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">target_speed</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span> </code>
<span class="doc doc-properties">
<small class="doc doc-property doc-property-special"><code>special</code></small>
</span>
<a class="headerlink" href="#ROAR.roar_autonomous_system.control_module.pure_pursuit_control.PurePursuitController.__init__" title="Permanent link">¤</a></h3>
<div class="doc doc-contents">
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>vehicle</code></td>
<td><code>Vehicle</code></td>
<td>
<p>Vehicle information</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>look_ahead_gain</code></td>
<td><code>float</code></td>
<td>
<p>Look ahead factor</p>
</td>
<td><code>0.1</code></td>
</tr>
<tr>
<td><code>look_ahead_distance</code></td>
<td><code>float</code></td>
<td>
<p>look ahead distance</p>
</td>
<td><code>2</code></td>
</tr>
<tr>
<td><code>target_speed</code></td>
<td><code></code></td>
<td>
<p>desired longitudinal speed to maintain</p>
</td>
<td><code>60</code></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>ROAR/roar_autonomous_system/control_module/pure_pursuit_control.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">vehicle</span><span class="p">:</span> <span class="n">Vehicle</span><span class="p">,</span>
        <span class="n">look_ahead_gain</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
        <span class="n">look_ahead_distance</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
        <span class="n">target_speed</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">"""</span>

<span class="sd">    Args:</span>
<span class="sd">        vehicle: Vehicle information</span>
<span class="sd">        look_ahead_gain: Look ahead factor</span>
<span class="sd">        look_ahead_distance: look ahead distance</span>
<span class="sd">        target_speed: desired longitudinal speed to maintain</span>
<span class="sd">    """</span>

    <span class="nb">super</span><span class="p">(</span><span class="n">PurePursuitController</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">vehicle</span><span class="o">=</span><span class="n">vehicle</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">target_speed</span> <span class="o">=</span> <span class="n">target_speed</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">look_ahead_gain</span> <span class="o">=</span> <span class="n">look_ahead_gain</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">look_ahead_distance</span> <span class="o">=</span> <span class="n">look_ahead_distance</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">latitunal_controller</span> <span class="o">=</span> <span class="n">LatitunalPurePursuitController</span><span class="p">(</span>
        <span class="n">vehicle</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">vehicle</span><span class="p">,</span>
        <span class="n">look_ahead_gain</span><span class="o">=</span><span class="n">look_ahead_gain</span><span class="p">,</span>
        <span class="n">look_ahead_distance</span><span class="o">=</span><span class="n">look_ahead_distance</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">longitunal_controller</span> <span class="o">=</span> <span class="n">LongitunalPurePursuitController</span><span class="p">(</span>
        <span class="n">vehicle</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">vehicle</span><span class="p">,</span> <span class="n">target_speed</span><span class="o">=</span><span class="n">target_speed</span>
    <span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="ROAR.roar_autonomous_system.control_module.pure_pursuit_control.PurePursuitController.run_step">
<code class="highlight language-python">
run_step<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vehicle</span><span class="p">,</span> <span class="n">next_waypoint</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> </code>
<a class="headerlink" href="#ROAR.roar_autonomous_system.control_module.pure_pursuit_control.PurePursuitController.run_step" title="Permanent link">¤</a></h3>
<div class="doc doc-contents">
<p>run one step of Pure Pursuit Control</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>vehicle</code></td>
<td><code>Vehicle</code></td>
<td>
<p>current vehicle state</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>next_waypoint</code></td>
<td><code>Transform</code></td>
<td>
<p>Next waypoint, Transform</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>**kwargs</code></td>
<td><code></code></td>
<td></td>
<td><code>{}</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>VehicleControl</code></td>
<td>
<p>Vehicle Control</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>ROAR/roar_autonomous_system/control_module/pure_pursuit_control.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">run_step</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">vehicle</span><span class="p">:</span> <span class="n">Vehicle</span><span class="p">,</span> <span class="n">next_waypoint</span><span class="p">:</span> <span class="n">Transform</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">VehicleControl</span><span class="p">:</span>
    <span class="sd">"""</span>
<span class="sd">    run one step of Pure Pursuit Control</span>

<span class="sd">    Args:</span>
<span class="sd">        vehicle: current vehicle state</span>
<span class="sd">        next_waypoint: Next waypoint, Transform</span>
<span class="sd">        **kwargs:</span>

<span class="sd">    Returns:</span>
<span class="sd">        Vehicle Control</span>

<span class="sd">    """</span>
    <span class="n">control</span> <span class="o">=</span> <span class="n">VehicleControl</span><span class="p">(</span>
        <span class="n">throttle</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">longitunal_controller</span><span class="o">.</span><span class="n">run_step</span><span class="p">(</span><span class="n">vehicle</span><span class="o">=</span><span class="n">vehicle</span><span class="p">),</span>
        <span class="n">steering</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">latitunal_controller</span><span class="o">.</span><span class="n">run_step</span><span class="p">(</span>
            <span class="n">vehicle</span><span class="o">=</span><span class="n">vehicle</span><span class="p">,</span> <span class="n">next_waypoint</span><span class="o">=</span><span class="n">next_waypoint</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">control</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</article>
</div>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-nav">
<nav aria-label="Footer" class="md-footer-nav__inner md-grid">
<a class="md-footer-nav__link md-footer-nav__link--prev" href="../agents/" rel="prev" title="Agents">
<div class="md-footer-nav__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</div>
<div class="md-footer-nav__title">
<div class="md-ellipsis">
<span class="md-footer-nav__direction">
                  Previous
                </span>
                Agents
              </div>
</div>
</a>
<a class="md-footer-nav__link md-footer-nav__link--next" href="../perceptions/" rel="next" title="Perception">
<div class="md-footer-nav__title">
<div class="md-ellipsis">
<span class="md-footer-nav__direction">
                  Next
                </span>
                Perception
              </div>
</div>
<div class="md-footer-nav__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"></path></svg>
</div>
</a>
</nav>
</div>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
          Material for MkDocs
        </a>
</div>
</div>
</div>
</footer>
</div>
<script src="../../../assets/javascripts/vendor.c3dc8c49.min.js"></script>
<script src="../../../assets/javascripts/bundle.f9edbbd5.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
<script>
        app = initialize({
          base: "../../..",
          features: [],
          search: Object.assign({
            worker: "../../../assets/javascripts/worker/search.8e2cddea.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
</body>
</html>